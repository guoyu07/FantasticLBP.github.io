<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="杭城小刘" />










<meta name="description" content="iOS开发、web开发 | 95后 | 海贼王、龙珠 | 乒乓球 健身 | 杭州">
<meta property="og:type" content="website">
<meta property="og:title" content="杭城小刘">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="杭城小刘">
<meta property="og:description" content="iOS开发、web开发 | 95后 | 海贼王、龙珠 | 乒乓球 健身 | 杭州">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="杭城小刘">
<meta name="twitter:description" content="iOS开发、web开发 | 95后 | 海贼王、龙珠 | 乒乓球 健身 | 杭州">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/2/"/>





  <title>杭城小刘</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">杭城小刘</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/10/工程大小优化之图片资源/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="杭城小刘">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.JPG">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="杭城小刘">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/10/工程大小优化之图片资源/" itemprop="url">工程大小优化之图片资源</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-10T14:04:27+08:00">
                2017-10-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="工程大小优化之图片资源"><a href="#工程大小优化之图片资源" class="headerlink" title="工程大小优化之图片资源"></a>工程大小优化之图片资源</h3><blockquote>
<p><em>摘要：</em>点点iOS项目本身功能较多，导致应用体积也比较大。一个Xcode工程下图片资源占用了很大的空间，且如果有些App需要一键换肤功能，呵呵，不知道得做多少图片。每套图片还需要设置1x@,2x@,3x@等</p>
</blockquote>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>IconFont技术起源于Web领域的Web Font技术。随着时间的推移，网页设计越来越漂亮。但是电脑预装的字体远远无法满足设计者的要求，于是Web Font技术诞生了。一个英文字库并不大，通过网络下载字体，完成网页的显示。有了Web Font技术，大大提升了设计师的发挥空间。</p>
<p>网页设计中图标需要适配多个分辨率，每个图标需要占用一次网络请求。于是有人想到了用Web Font的方法来解决这两个问题，就是IconFont技术。将矢量的图标做成字体，一次网络请求就够了，可以保真缩放。解决这个问题的另一个方式是图片拼合的Sprite图。</p>
<p>Web领域使用IconFont类似的技术已经多年，当我在15年接触BootStrap的时候Font Awesome技术大行其道。最近IconFont技术在iOS图片资源方面得以应用，最近有点时间自己研究整理了一番，在此记录学习点滴。</p>
<h2 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h2><ul>
<li>减小体积，字体文件比图片要小</li>
<li>图标保真缩放，解决2x/3x乃至将来的nx图问题</li>
<li>方便更改颜色大小，图片复用</li>
</ul>
<h2 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h2><ul>
<li>只适用于<br><code>纯色icon</code></li>
<li>使用unicode字符难以理解</li>
<li>需要维护字体库</li>
</ul>
<p>网上说了一大堆如何制作IconFont的方法，在此不做讨论。</p>
<h2 id="我们说说怎么用"><a href="#我们说说怎么用" class="headerlink" title="我们说说怎么用"></a>我们说说怎么用</h2><ol>
<li>首先选取一些有丰富资源的网站，我使用阿里的IconFont多年，其他的没去研究，所以此处直接使用阿里的产品。地址：<a href="http://www.iconfont.cn/plus" target="_blank" rel="external">http://www.iconfont.cn/plus</a></li>
<li>打开网站在线挑选好合适的图标加入购物车，如图<img src="https://raw.githubusercontent.com/FantasticLBP/iOSKonwledge-Kit/master/assets/屏幕快照%202017-05-28%20下午2.43.33.png" alt="阿里IconFont" title="阿里IconFont"></li>
<li>选择好之后在购物车查看，然后点击下载代码<img src="https://raw.githubusercontent.com/FantasticLBP/iOSKonwledge-Kit/master/assets/屏幕快照%202017-05-28%20下午2.43.48.png" alt="下载IconFont" title="下载IconFont"></li>
<li>打开下载好的文件，其机构如下，我们在iOS项目开发过程中使用unicode的形式使用IconFont,所以打开demo_unicode.html<br><img src="https://raw.githubusercontent.com/FantasticLBP/iOSKonwledge-Kit/master/assets/屏幕快照%202017-05-28%20下午2.44.09.png" alt="下载文件目录结构" title="下载文件目录结构"><br><img src="https://raw.githubusercontent.com/FantasticLBP/iOSKonwledge-Kit/master/assets/屏幕快照%202017-05-28%20下午2.44.22.png" alt="unicode形式使用IconFont" title="unicode形式使用IconFont"></li>
<li>注意：创建 UIFont 使用的是字体名，而不是文件名；文本值为 8 位的 Unicode 字符，我们可以打开 demo.html 查找每个图标所对应的 HTML 实体 Unicode 码，比如： “店” 对应的 HTML 实体 Unicode 码为：0x3439 转换后为：\U00003439 就是将 0x 替换为 \U 中间用 0 填补满长度为 8 个字符</li>
</ol>
<h1 id="Xcode中使用IconFont"><a href="#Xcode中使用IconFont" class="headerlink" title="Xcode中使用IconFont"></a>Xcode中使用IconFont</h1><p>初步尝试使用</p>
<ol>
<li>首先看看如何简单实用IconFont</li>
<li>首先将下载好的文件夹中的<strong>iconfont.ttf</strong>加入到Xcode工程中，确保加入成功在Build检查<img src="https://raw.githubusercontent.com/FantasticLBP/iOSKonwledge-Kit/master/assets/屏幕快照%202017-05-28%20下午2.51.36.png" alt="Xcode检查引入结果" title="Xcode检查引入结果"></li>
<li>怎么用？</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">NSMutableAttributedString *attributedStr = [[NSMutableAttributedString alloc] initWithString:@&quot;\U0000e696  \U0000e6ab  \U0000e6ac  \U0000e6ae&quot;];</div><div class="line">    [attributedStr addAttribute:NSForegroundColorAttributeName value:[UIColor redColor] range:NSMakeRange(0, 1)];</div><div class="line">    [attributedStr addAttribute:NSForegroundColorAttributeName value:[UIColor orangeColor] range:NSMakeRange(3, 1)];</div><div class="line">    [attributedStr addAttribute:NSForegroundColorAttributeName value:[UIColor blackColor] range:NSMakeRange(9, 1)];</div><div class="line">    self.label.attributedText = attributedStr;</div><div class="line"></div><div class="line">[self.view addSubview:self.label];</div><div class="line"></div><div class="line">pragma mark - getter and setter</div><div class="line">-(UILabel *)label&#123;</div><div class="line">       if (!_label) &#123;</div><div class="line">           _label = [[UILabel alloc] initWithFrame:CGRectMake(100, 100, BoundWidth-200, 40)];</div><div class="line">           _label.font = [UIFont fontWithName:@&quot;iconfont&quot; size:24];</div><div class="line">           _label.textColor = [UIColor purpleColor];</div><div class="line">       &#125;</div><div class="line">       return _label;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<h4 id="做进一步封装，实用更加方便"><a href="#做进一步封装，实用更加方便" class="headerlink" title="做进一步封装，实用更加方便"></a>做进一步封装，实用更加方便</h4><p>利用IconFont生成1个UIImage只需要<strong>LBPIconFontmake(par1, par2, par3)</strong>，par1:iconfont的unicode值；par2:图片大小；par3:图片的颜色值。</p>

<p>其中，LBPIconFontmake是一个宏，#define LBPIconFontmake(text,size,color) [[LBPFontInfo alloc] initWithText:text withSize:size andColor:color]。</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">self.latestImageView.image = [UIImage iconWithInfo:LBPIconFontmake(@&quot;\U0000e6ac&quot;, 60, @&quot;000066&quot;) ];</div></pre></td></tr></table></figure>
<p><img src="https://github.com/FantasticLBP/iOSKonwledge-Kit/raw/master/assets/屏幕快照%202017-05-28%20下午2.56.00.png" alt="封装后的工程目录结构" title="封装后的工程目录结构"></p>
<ol>
<li>LBPFontInfo来封装字体信息</li>
<li>UIColor+picker根据十六进制字符串来设置颜色</li>
<li>LBPIconFont向系统中注册IconFont字体库，并使用</li>
<li>UIImage+LBPIconFont封装一个使用IconFont的Image分类</li>
</ol>
<h1 id="效果图"><a href="#效果图" class="headerlink" title="效果图"></a>效果图</h1><p><img src="https://raw.githubusercontent.com/FantasticLBP/iOSKonwledge-Kit/master/assets/Simulator%20Screen%20Shot%202017年5月28日%20下午3.19.44.png" alt="效果图" title="效果图"></p>
<h1 id="Demo地址"><a href="#Demo地址" class="headerlink" title="Demo地址"></a>Demo地址</h1><p><a href="https://github.com/FantasticLBP/IconFont_Demo" target="_blank" rel="external">https://github.com/FantasticLBP/IconFont_Demo</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/10/开始hexo博客之旅/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="杭城小刘">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.JPG">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="杭城小刘">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/10/开始hexo博客之旅/" itemprop="url">开始hexo博客之旅</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-10T14:04:27+08:00">
                2017-10-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="首先列一下关键的几个步骤，网站的教程特别多。要看的自己搜一搜"><a href="#首先列一下关键的几个步骤，网站的教程特别多。要看的自己搜一搜" class="headerlink" title="首先列一下关键的几个步骤，网站的教程特别多。要看的自己搜一搜"></a>首先列一下关键的几个步骤，网站的教程特别多。要看的自己搜一搜</h3><p>1、下载安装node环境<br>2、本机配置git环境<br>3、node安装hexo环境<br>4、下载自己细化的主题，我选择的是next主题<br>5、更改next主题文件夹下的 _config.yml 文件，做一些常用设置的更改<br>6、开始写文章，格式采用markdown语法，写完后发布一下 hexo d</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/10/-last-child与-last-of-type你只是会用，有研究过区别吗？/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="杭城小刘">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.JPG">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="杭城小刘">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/10/-last-child与-last-of-type你只是会用，有研究过区别吗？/" itemprop="url">-last-child与-last-of-type你只是会用，有研究过区别吗？</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-10T14:04:27+08:00">
                2017-10-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="last-child与-last-of-type"><a href="#last-child与-last-of-type" class="headerlink" title=":last-child与:last-of-type"></a>:last-child与:last-of-type</h1><blockquote>
<p>同学们遇到过给同一组元素的最后一个元素设置css失效的情况吗？我遇到过，当时使用:last-child居然不起作用，看到名字不科学啊，明明是“最后一个元素”，那为什么设置CSS失效呢？今天来一探究竟吧</p>
</blockquote>
<ul>
<li>先看一组<code>:last-child</code>正常工作的代码</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html&gt;</div><div class="line"></div><div class="line">    &lt;head&gt;</div><div class="line">        &lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line">        &lt;title&gt;:last-child、:last-of-type&lt;/title&gt;</div><div class="line">        &lt;script src=&quot;../../lib/jquery-2.1.0.js&quot;&gt;&lt;/script&gt;</div><div class="line">        &lt;style&gt;</div><div class="line">            ul &#123;</div><div class="line">                margin: 100px 0;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            li &#123;</div><div class="line">                list-style: circle;</div><div class="line">                border-bottom: 1px solid #000000;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            li:last-child &#123;</div><div class="line">                border-color: red;</div><div class="line">            &#125;</div><div class="line">        &lt;/style&gt;</div><div class="line"></div><div class="line">    &lt;/head&gt;</div><div class="line"></div><div class="line">    &lt;body&gt;</div><div class="line">        &lt;ul&gt;</div><div class="line">            &lt;li&gt;1&lt;/li&gt;</div><div class="line">            &lt;li&gt;2&lt;/li&gt;</div><div class="line">            &lt;li&gt;3&lt;/li&gt;</div><div class="line">            &lt;!--&lt;p&gt;我是来骚扰的&lt;/p&gt;--&gt;</div><div class="line">        &lt;/ul&gt;</div><div class="line">    &lt;/body&gt;</div><div class="line"></div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/FantasticLBP/web/master/assets/屏幕快照%202017-06-17%20下午4.56.03.png" alt="效果图1" title="效果图1"></p>
<ul>
<li>再先看一组<code>:last-child</code>不正常工作的代码</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html&gt;</div><div class="line"></div><div class="line">    &lt;head&gt;</div><div class="line">        &lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line">        &lt;title&gt;:last-child、:last-of-type&lt;/title&gt;</div><div class="line">        &lt;script src=&quot;../../lib/jquery-2.1.0.js&quot;&gt;&lt;/script&gt;</div><div class="line">        &lt;style&gt;</div><div class="line">            ul &#123;</div><div class="line">                margin: 100px 0;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            li &#123;</div><div class="line">                list-style: circle;</div><div class="line">                border-bottom: 1px solid #000000;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            li:last-child &#123;</div><div class="line">                border-color: red;</div><div class="line">            &#125;</div><div class="line">        &lt;/style&gt;</div><div class="line"></div><div class="line">    &lt;/head&gt;</div><div class="line"></div><div class="line">    &lt;body&gt;</div><div class="line">        &lt;ul&gt;</div><div class="line">            &lt;li&gt;1&lt;/li&gt;</div><div class="line">            &lt;li&gt;2&lt;/li&gt;</div><div class="line">            &lt;li&gt;3&lt;/li&gt;</div><div class="line">            &lt;p&gt;我是来骚扰的&lt;/p&gt;</div><div class="line">        &lt;/ul&gt;</div><div class="line">    &lt;/body&gt;</div><div class="line"></div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p><img src="https://github.com/FantasticLBP/web/blob/master/assets/屏幕快照%202017-06-17%20下午4.57.23.png?raw=true" alt="效果图2" title="效果图2"></p>
<p>问题抛出来了，那么来研究下:last-child和:last-of-type究竟是何方神圣。</p>
<ol>
<li><p>:last-child：<strong>The last-child CSS pseudo-class represents the last element among a group of sibling elements.（:last-child这个css伪类代表的一组兄弟元素当中最后一个元素）但经过代码发现，它说的一组元素应该是指其父元素的所有子元素且类型为:last-child前面指定的类型的一组元素。</strong></p>
</li>
<li><p>:last-of-type：<strong>The last-of-type CSS pseudo-class represents the last element of its type among a group of sibling elements.（</strong>:last-of-type这个css伪类代表其类型的一组兄弟元素中的最后一个元素<strong>）所以它指的是和</strong>:last-of-type前面的元素类型一致的一组元素的最后一个元素</p>
</li>
</ol>
<p>同理：:nth-last-child和:nth-last-of-type的区别在于父元素的子元素中且与:nth-last-child前面的元素类型一致的最后一个元素</p>
<p>做个验证</p>
<ul>
<li>:nth-last-child可以正常工作的代码</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html&gt;</div><div class="line">	&lt;head&gt;</div><div class="line">		&lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line">		&lt;title&gt;:last-child、:last-of-type&lt;/title&gt;</div><div class="line">		&lt;script src=&quot;../../lib/jquery-2.1.0.js&quot;&gt;&lt;/script&gt;</div><div class="line">		&lt;style&gt;</div><div class="line">			ul &#123;</div><div class="line">				margin: 100px 0;</div><div class="line">			&#125;</div><div class="line">	</div><div class="line">			li &#123;</div><div class="line">				list-style: circle;</div><div class="line">				border-bottom: 1px solid #000000;</div><div class="line">			&#125;</div><div class="line">			li:nth-last-child(1)&#123;</div><div class="line">				border-color: red;</div><div class="line">			&#125;</div><div class="line">	</div><div class="line">		&lt;/style&gt;</div><div class="line"></div><div class="line">	&lt;/head&gt;</div><div class="line"></div><div class="line">	&lt;body&gt;</div><div class="line">		&lt;ul&gt;</div><div class="line">			&lt;li&gt;1&lt;/li&gt;</div><div class="line">			&lt;li&gt;2&lt;/li&gt;</div><div class="line">			&lt;li&gt;3&lt;/li&gt;</div><div class="line">			&lt;!--&lt;p&gt;我是来骚扰的&lt;/p&gt;--&gt;</div><div class="line">		&lt;/ul&gt;</div><div class="line">	&lt;/body&gt;</div><div class="line"></div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p><img src="https://github.com/FantasticLBP/web/blob/master/assets/屏幕快照%202017-06-17%20下午5.25.01.png?raw=true" alt="效果图3" title="效果图3"></p>
<ul>
<li>:nth-last-child不能正常工作的代码</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line"> &lt;html&gt;</div><div class="line"> 	&lt;head&gt;</div><div class="line"> 		&lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line"> 		&lt;title&gt;:last-child、:last-of-type&lt;/title&gt;</div><div class="line"> 		&lt;script src=&quot;../../lib/jquery-2.1.0.js&quot;&gt;&lt;/script&gt;</div><div class="line"> 		&lt;style&gt;</div><div class="line"> 			ul &#123;</div><div class="line"> 				margin: 100px 0;</div><div class="line"> 			&#125;</div><div class="line">		</div><div class="line"> 			li &#123;</div><div class="line"> 				list-style: circle;</div><div class="line"> 				border-bottom: 1px solid #000000;</div><div class="line"> 			&#125;</div><div class="line">	</div><div class="line">		</div><div class="line"> 			li:nth-last-child(1)&#123;</div><div class="line"> 				border-color: red;</div><div class="line"> 			&#125;</div><div class="line">		</div><div class="line"> 		&lt;/style&gt;</div><div class="line"></div><div class="line"> 	&lt;/head&gt;</div><div class="line"></div><div class="line"> 	&lt;body&gt;</div><div class="line"> 		&lt;ul&gt;</div><div class="line"> 			&lt;li&gt;1&lt;/li&gt;</div><div class="line"> 			&lt;li&gt;2&lt;/li&gt;</div><div class="line"> 			&lt;li&gt;3&lt;/li&gt;</div><div class="line"> 			&lt;p&gt;我是来骚扰的&lt;/p&gt;</div><div class="line"> 		&lt;/ul&gt;</div><div class="line"> 	&lt;/body&gt;</div><div class="line"></div><div class="line"> &lt;/html&gt;</div></pre></td></tr></table></figure>
<p><img src="https://github.com/FantasticLBP/web/blob/master/assets/屏幕快照%202017-06-17%20下午4.57.23.png?raw=true" alt="效果图2" title="效果图2"></p>
<ul>
<li>接下来:nth-last-of-type闪亮登场</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html&gt;</div><div class="line">	&lt;head&gt;</div><div class="line">		&lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line">		&lt;title&gt;:last-child、:last-of-type&lt;/title&gt;</div><div class="line">		&lt;script src=&quot;../../lib/jquery-2.1.0.js&quot;&gt;&lt;/script&gt;</div><div class="line">		&lt;style&gt;</div><div class="line">			ul &#123;</div><div class="line">				margin: 100px 0;</div><div class="line">			&#125;</div><div class="line">			</div><div class="line">			li &#123;</div><div class="line">				list-style: circle;</div><div class="line">				border-bottom: 1px solid #000000;</div><div class="line">			&#125;</div><div class="line">		</div><div class="line">			</div><div class="line">			li:nth-last-of-type(1)&#123;</div><div class="line">				border-color: red;</div><div class="line">			&#125;</div><div class="line">			</div><div class="line">		&lt;/style&gt;</div><div class="line"></div><div class="line">	&lt;/head&gt;</div><div class="line"></div><div class="line">	&lt;body&gt;</div><div class="line">		&lt;ul&gt;</div><div class="line">			&lt;li&gt;1&lt;/li&gt;</div><div class="line">			&lt;li&gt;2&lt;/li&gt;</div><div class="line">			&lt;li&gt;3&lt;/li&gt;</div><div class="line">			&lt;p&gt;我是来骚扰的&lt;/p&gt;</div><div class="line">		&lt;/ul&gt;</div><div class="line">	&lt;/body&gt;</div><div class="line"></div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p><img src="https://github.com/FantasticLBP/web/blob/master/assets/屏幕快照%202017-06-17%20下午5.25.01.png?raw=true" alt="效果图3" title="效果图3"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/10/接口要怎么对？你知道正确的姿势吗/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="杭城小刘">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.JPG">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="杭城小刘">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/10/接口要怎么对？你知道正确的姿势吗/" itemprop="url">接口要怎么对？你知道正确的姿势吗</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-10T14:04:27+08:00">
                2017-10-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>今天后台同事去温州出差，自己又多了一次远程协作办公的经历-对接口</p>
</blockquote>
<h1 id="1、背景"><a href="#1、背景" class="headerlink" title="1、背景"></a>1、背景</h1><p>我在公司主要做iOS和h5开发，懂点php开发（独立开发过一个完整的项目，写的了SQL、写的了接口、写的了后台）。</p>
<p>对接口的时候前端h5页面已经完成，开始了接口对接工作，但是接口对接并不是那么顺利，负责接口的人是一位“颇有”经验老司机，他看上去28左右的样子（小子我22）</p>
<h1 id="2、事情经过"><a href="#2、事情经过" class="headerlink" title="2、事情经过"></a>2、事情经过</h1><p>我写好ajax去请求数据发现这次对接并不是很友善。</p>
<ul>
<li>起初显示跨域访问，为了方便我让他后端设置运行跨域访问，因为没必要限制访问（加了Access-Control-Allow-Origin:*)</li>
<li>后来发现返回的数据并不和善，里面携带了大量的html标签，设置了“dataType:json”页面回调走入error里面</li>
<li>跟他叙述了事情经过居然说他用浏览器测试发现在页面上显示的数据是正常的，肯定是我接收数据解析出错</li>
<li>在下不服，我要跟你撕逼（讲道理）</li>
<li>这是我的观点“接口写好<strong>看的不是浏览器上的结果</strong>，要看<strong>response</strong>，你写的接口是要返回给c端或者b端的人去解析，再去展示，不是直接解析到浏览器上的“</li>
<li>再抛出一个我自己写的接口给他举例子</li>
</ul>
<h1 id="3、附图"><a href="#3、附图" class="headerlink" title="3、附图"></a>3、附图</h1><p><img src="https://raw.githubusercontent.com/FantasticLBP/iOSKonwledge-Kit/master/assets/屏幕快照%202017-06-07%20下午3.21.18.png" alt="接口1" title="接口1"></p>
<p><img src="https://github.com/FantasticLBP/iOSKonwledge-Kit/blob/master/assets/屏幕快照%202017-06-07%20下午3.21.182.png?raw=true" alt="接口2" title="接口2"><br><img src="https://github.com/FantasticLBP/iOSKonwledge-Kit/blob/master/assets/屏幕快照%202017-06-07%20下午3.21.183.png?raw=true" alt="接口3" title="接口3"></p>
<h1 id="4、启发"><a href="#4、启发" class="headerlink" title="4、启发"></a>4、启发</h1><p>广大开发者朋友们，做开发不管是web还是客户端开发网络知识以及基本的调试知识一定要有，遇到问题一层层排除定位再去解决。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/10/摇一摇根据城市位置推荐酒店/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="杭城小刘">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.JPG">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="杭城小刘">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/10/摇一摇根据城市位置推荐酒店/" itemprop="url">摇一摇根据城市位置推荐酒店</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-10T14:04:27+08:00">
                2017-10-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>###摇一摇根据城市位置推荐酒店客户端###</p>
<p>1、实现摇一摇并震动需要导入头文件。#import <audiotoolbox audiotoolbox.h=""></audiotoolbox></p>
<p>2、当前城市定位，可以看我之前的文字<a href="http://www.jianshu.com/p/b9f8881292ab" target="_blank" rel="external">快速定位</a></p>
<p>3、让vc支持摇一摇。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[self becomeFirstResponder];</div><div class="line">[UIApplication sharedApplication].applicationSupportsShakeToEdit = YES;</div></pre></td></tr></table></figure>
<p>4、关键代码<br>在移动的时候将手机震动，并将view显示出来，并请求接口，将酒店显示出来，点击进入到酒店详情界面。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">#pragma mark - UIResponder</div><div class="line">-(void)motionBegan:(UIEventSubtype)motion withEvent:(UIEvent *)event&#123;</div><div class="line">AudioServicesPlaySystemSound(kSystemSoundID_Vibrate);</div><div class="line">self.bgView.alpha = 0;</div><div class="line">self.bgView.hidden = YES;</div><div class="line">[UIView animateWithDuration:1.0 animations:^&#123;</div><div class="line">[self getRandomHotel];</div><div class="line">self.bgView.alpha = 1;</div><div class="line">self.bgView.hidden = NO;</div><div class="line">self.hotelImage.image = [UIImage imageNamed:@&quot;My_about&quot;];</div><div class="line">self.label.text = @&quot;您已经成功摇到一个酒店，不喜欢？换个姿势再来一次&quot;;</div><div class="line">[self.label sizeToFit];</div><div class="line">self.hotelImage.contentMode = UIViewContentModeScaleAspectFill;</div><div class="line">self.hotelImage.autoresizingMask = UIViewAutoresizingFlexibleHeight;</div><div class="line">self.hotelImage.clipsToBounds = YES;</div><div class="line">//动态设置uilabel的高度</div><div class="line">self.hotelLabel.numberOfLines = 0;</div><div class="line">self.hotelLabel.lineBreakMode = NSLineBreakByWordWrapping;</div><div class="line">&#125; completion:^(BOOL finished) &#123;</div><div class="line"></div><div class="line">&#125;];</div><div class="line">NSLog(@&quot;摇一摇开始&quot;);</div><div class="line">return ;</div><div class="line">&#125;</div><div class="line"></div><div class="line">-(void)motionCancelled:(UIEventSubtype)motion withEvent:(UIEvent *)event&#123;</div><div class="line">NSLog(@&quot;取消摇一摇&quot;);</div><div class="line">return ;</div><div class="line">&#125;</div><div class="line"></div><div class="line">-(void)motionEnded:(UIEventSubtype)motion withEvent:(UIEvent *)event&#123;</div><div class="line">if (motion ==UIEventSubtypeMotionShake )&#123;</div><div class="line">NSLog(@&quot;摇一摇结束&quot;);</div><div class="line">&#125;</div><div class="line">return ;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>全部代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">//</div><div class="line">// ShakeViewController.m</div><div class="line">// 住哪儿</div><div class="line">//</div><div class="line">// Created by geek on 2017/4/30.</div><div class="line">// Copyright © 2017年 geek. All rights reserved.</div><div class="line">//</div><div class="line"></div><div class="line">#import &quot;ShakeViewController.h&quot;</div><div class="line">#import &quot;HotelDetailVC.h&quot;</div><div class="line">#import &quot;HotelsModel.h&quot;</div><div class="line">#import &quot;LocationManager.h&quot;</div><div class="line">#import &lt;AudioToolbox/AudioToolbox.h&gt;</div><div class="line"></div><div class="line">@interface ShakeViewController ()&lt;LocationManagerDelegate&gt;</div><div class="line">@property (nonatomic, strong) UIImageView *imageView;</div><div class="line">@property (nonatomic, strong) UILabel *label;</div><div class="line">@property (nonatomic, strong) UIView *bgView;</div><div class="line">@property (nonatomic, strong) UILabel *hotelLabel;</div><div class="line">@property (nonatomic, strong) UIImageView *hotelImage;</div><div class="line">@property (nonatomic, strong) HotelsModel *model;</div><div class="line">@property (nonatomic, strong) LocationManager *locationManager;</div><div class="line">@property (nonatomic, strong) NSString *cityName;</div><div class="line">@property (nonatomic, assign) BOOL showHotel;</div><div class="line">@end</div><div class="line"></div><div class="line">@implementation ShakeViewController</div><div class="line"></div><div class="line">- (void)viewDidLoad &#123;</div><div class="line">[super viewDidLoad];</div><div class="line">[self setupUI];</div><div class="line">[self autoLocate];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)setupUI &#123;</div><div class="line">[self.view addSubview:self.imageView];</div><div class="line">[self becomeFirstResponder];</div><div class="line">[UIApplication sharedApplication].applicationSupportsShakeToEdit = YES;</div><div class="line">[self.view addSubview:self.label];</div><div class="line">[self.view addSubview:self.bgView];</div><div class="line">[self.bgView addSubview:self.hotelImage];</div><div class="line">[self.bgView addSubview:self.hotelLabel];</div><div class="line">&#125;</div><div class="line"></div><div class="line">-(void)autoLocate&#123;</div><div class="line">self.locationManager = [LocationManager sharedInstance];</div><div class="line">self.locationManager.delegate = self;</div><div class="line">[self.locationManager autoLocate];</div><div class="line">&#125;</div><div class="line"></div><div class="line">-(void)getRandomHotel&#123;</div><div class="line">NSString *url = [NSString stringWithFormat:@&quot;%@%@&quot;,Base_Url,@&quot;/controller/api/RandomHotel.php&quot;];</div><div class="line">NSMutableDictionary *paras = [NSMutableDictionary dictionary];</div><div class="line">paras[@&quot;key&quot;] = AppKey;</div><div class="line">paras[@&quot;city&quot;] = self.cityName;</div><div class="line">[SVProgressHUD showWithStatus:@&quot;正在获取酒店数据&quot;];</div><div class="line">[AFNetPackage getJSONWithUrl:url parameters:paras success:^(id responseObject) &#123;</div><div class="line">NSDictionary *dic = [NSJSONSerialization JSONObjectWithData:responseObject options:NSJSONReadingMutableLeaves error:nil];</div><div class="line">if ([dic[@&quot;code&quot;] integerValue] == 200) &#123;</div><div class="line">[SVProgressHUD dismiss];</div><div class="line">NSDictionary *dic = [NSJSONSerialization JSONObjectWithData:responseObject options:NSJSONReadingMutableLeaves error:nil];</div><div class="line">self.model = [HotelsModel yy_modelWithJSON:dic[@&quot;data&quot;]];</div><div class="line">self.hotelLabel.text = self.model.hotelName;</div><div class="line">[self.hotelLabel sizeToFit];</div><div class="line">[self.hotelImage sd_setImageWithURL:[NSURL URLWithString: [NSString stringWithFormat:@&quot;%@/%@&quot;,Base_Url,self.model.image1]] placeholderImage:[UIImage imageNamed:@&quot;jpg-1&quot;]];</div><div class="line">&#125;</div><div class="line">&#125; fail:^&#123;</div><div class="line">[SVProgressHUD dismiss];</div><div class="line">&#125;];</div><div class="line">&#125;</div><div class="line"></div><div class="line">-(void)watchDetail&#123;</div><div class="line">HotelDetailVC *vc = [[HotelDetailVC alloc] init];</div><div class="line">vc.startPeriod = [[NSDate date] todayString];</div><div class="line">vc.leavePerios = [[NSDate date] GetTomorrowDayString];</div><div class="line">vc.model = self.model;</div><div class="line">[self.navigationController pushViewController:vc animated:YES];</div><div class="line">&#125;</div><div class="line"></div><div class="line">#pragma mark - LocationManagerDelegate</div><div class="line">-(void)locationManager:(LocationManager *)locationManager didGotLocation:(NSString *)location&#123;</div><div class="line">self.cityName = location;</div><div class="line">&#125;</div><div class="line"></div><div class="line">#pragma mark - UIResponder</div><div class="line">-(void)motionBegan:(UIEventSubtype)motion withEvent:(UIEvent *)event&#123;</div><div class="line">AudioServicesPlaySystemSound(kSystemSoundID_Vibrate);</div><div class="line">self.bgView.alpha = 0;</div><div class="line">self.bgView.hidden = YES;</div><div class="line">[UIView animateWithDuration:1.0 animations:^&#123;</div><div class="line">[self getRandomHotel];</div><div class="line">self.bgView.alpha = 1;</div><div class="line">self.bgView.hidden = NO;</div><div class="line">self.hotelImage.image = [UIImage imageNamed:@&quot;My_about&quot;];</div><div class="line">self.label.text = @&quot;您已经成功摇到一个酒店，不喜欢？换个姿势再来一次&quot;;</div><div class="line">[self.label sizeToFit];</div><div class="line">self.hotelImage.contentMode = UIViewContentModeScaleAspectFill;</div><div class="line">self.hotelImage.autoresizingMask = UIViewAutoresizingFlexibleHeight;</div><div class="line">self.hotelImage.clipsToBounds = YES;</div><div class="line">//动态设置uilabel的高度</div><div class="line">self.hotelLabel.numberOfLines = 0;</div><div class="line">self.hotelLabel.lineBreakMode = NSLineBreakByWordWrapping;</div><div class="line">&#125; completion:^(BOOL finished) &#123;</div><div class="line"></div><div class="line">&#125;];</div><div class="line">NSLog(@&quot;摇一摇开始&quot;);</div><div class="line">return ;</div><div class="line">&#125;</div><div class="line"></div><div class="line">-(void)motionCancelled:(UIEventSubtype)motion withEvent:(UIEvent *)event&#123;</div><div class="line">NSLog(@&quot;取消摇一摇&quot;);</div><div class="line">return ;</div><div class="line">&#125;</div><div class="line"></div><div class="line">-(void)motionEnded:(UIEventSubtype)motion withEvent:(UIEvent *)event&#123;</div><div class="line">if (motion ==UIEventSubtypeMotionShake )&#123;</div><div class="line">NSLog(@&quot;摇一摇结束&quot;);</div><div class="line">&#125;</div><div class="line">return ;</div><div class="line">&#125;</div><div class="line"></div><div class="line">#pragma mark - lazy load</div><div class="line">-(UIImageView *)imageView&#123;</div><div class="line">if (!_imageView) &#123;</div><div class="line">_imageView = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, BoundWidth, BoundHeight-60)];</div><div class="line">_imageView.image = [UIImage imageNamed:@&quot;shake_news_bgVPic&quot;];</div><div class="line">&#125;</div><div class="line">return _imageView;</div><div class="line">&#125;</div><div class="line"></div><div class="line">-(UILabel *)label&#123;</div><div class="line">if (!_label) &#123;</div><div class="line">_label = [[UILabel alloc] initWithFrame:CGRectMake(BoundWidth/2-200/2, BoundHeight - 60 -270, 200, 21)];</div><div class="line">_label.textColor = [UIColor whiteColor];</div><div class="line">_label.numberOfLines = 2;</div><div class="line">_label.font = [UIFont systemFontOfSize:15];</div><div class="line">_label.text = @&quot;摇一摇，为您随机推荐酒店&quot;;</div><div class="line">[_label sizeToFit];</div><div class="line">&#125;</div><div class="line">return _label;</div><div class="line">&#125;</div><div class="line"></div><div class="line">-(UIView *)bgView&#123;</div><div class="line">if (!_bgView) &#123;</div><div class="line">_bgView = [[UIView alloc] initWithFrame:CGRectMake(15, BoundHeight-260, BoundWidth-30, 120)];</div><div class="line">_bgView.backgroundColor = [UIColor whiteColor];</div><div class="line">_bgView.layer.cornerRadius = 10;</div><div class="line">_bgView.clipsToBounds = YES;</div><div class="line">_bgView.alpha = 0;</div><div class="line">UITapGestureRecognizer *tap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(watchDetail)];</div><div class="line">tap.cancelsTouchesInView = YES;</div><div class="line">_bgView.userInteractionEnabled = YES;</div><div class="line">[_bgView addGestureRecognizer:tap];</div><div class="line">&#125;</div><div class="line">return _bgView;</div><div class="line">&#125;</div><div class="line"></div><div class="line">-(UIImageView *)hotelImage&#123;</div><div class="line">if (!_hotelImage) &#123;</div><div class="line">_hotelImage = [[UIImageView alloc] initWithFrame:CGRectMake(10, 10, 100, 100)];</div><div class="line">_hotelImage.contentMode = UIViewContentModeScaleAspectFit;</div><div class="line">&#125;</div><div class="line">return _hotelImage;</div><div class="line">&#125;</div><div class="line"></div><div class="line">-(UILabel *)hotelLabel&#123;</div><div class="line">if (!_hotelLabel) &#123;</div><div class="line">_hotelLabel = [[UILabel alloc] initWithFrame:CGRectMake(135, 40, BoundWidth - 30- 140, 40)];</div><div class="line">_hotelLabel.textColor = [UIColor blackColor];</div><div class="line">_hotelLabel.font = [UIFont systemFontOfSize:20];</div><div class="line">&#125;</div><div class="line">return _hotelLabel;</div><div class="line">&#125;</div><div class="line">@end</div></pre></td></tr></table></figure>
<p>效果图<br><img src="https://static.oschina.net/uploads/img/201705/01101002_gBbo.png" alt="摇一摇之前" title="在这里输入图片标题"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/2287777-9e1f741fb37dcc31.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="摇一摇摇到酒店"></p>
<p>###随机推荐酒店后台实现###</p>
<p>实现思路：</p>
<p>1、接收客户端传来的参数：城市名称、App key；</p>
<p>2、根据城市名称模糊搜索出酒店数据；</p>
<p>3、根据搜索出的酒店数据数组长度，生成1个随机数，随机数范围[1,数组长度]；</p>
<p>4、利用封装好的Responese将数据返给客户端</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line"></div><div class="line">/**</div><div class="line">* Created by PhpStorm.</div><div class="line">* User: geek</div><div class="line">* Date: 2017/3/9</div><div class="line">* Time: 上午9:24</div><div class="line">*/</div><div class="line"></div><div class="line">header(&apos;content-type:text.html;charset=utf-8&apos;);</div><div class="line">error_reporting(0);</div><div class="line">require_once &apos;../../model/PdoMySQL.class.php&apos;;</div><div class="line">require_once &apos;../../model/config.php&apos;;</div><div class="line">require_once &apos;Response.php&apos;;</div><div class="line"></div><div class="line"></div><div class="line">class RandomHotel</div><div class="line">&#123;</div><div class="line">private $tableName = &quot;hotel&quot;;</div><div class="line">private $key = &quot;&quot;;</div><div class="line">private $city = &quot;&quot;;</div><div class="line"></div><div class="line">protected static $_instance = null;</div><div class="line"></div><div class="line">private function __construct()</div><div class="line">&#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line">private function __clone()</div><div class="line">&#123;</div><div class="line">// TODO: Implement __clone() method.</div><div class="line">&#125;</div><div class="line"></div><div class="line">public function sharedInstance()&#123;</div><div class="line">if(self::$_instance == null)&#123;</div><div class="line">self::$_instance = new self();</div><div class="line">&#125;</div><div class="line">return self::$_instance;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">private function random($start,$end)&#123;</div><div class="line">$tmp=array();</div><div class="line">while(count($tmp)&lt;1)&#123;</div><div class="line">$tmp[]=mt_rand($start,$end);</div><div class="line">$tmp=array_unique($tmp);</div><div class="line">&#125;</div><div class="line">return $tmp[0]-1;</div><div class="line">&#125;</div><div class="line"></div><div class="line">public function getHotel()&#123;</div><div class="line">$mysqlPdo = new PdoMySQL();</div><div class="line"></div><div class="line">self.$this-&gt;key = $_REQUEST[&quot;key&quot;];</div><div class="line">self.$this-&gt;city = $_REQUEST[&quot;city&quot;];</div><div class="line"></div><div class="line">if($this-&gt;key == &quot;&quot; || $this-&gt;key !== &quot;TheHotelReversationApplication&quot; )&#123;</div><div class="line">Response::show(201,&quot;fail&quot;,&quot;非安全的数据请求&quot;,&quot;json&quot;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">$pdo=new PdoMySQL();</div><div class="line">$res = $pdo-&gt;find($this-&gt;tableName,&quot;address like &apos;%&quot;.$this-&gt;city.&quot;%&apos;&quot;);</div><div class="line"></div><div class="line">$random = $this-&gt;random(1,count($res));</div><div class="line"></div><div class="line">if($res)&#123;</div><div class="line">//随机酒店获取成功</div><div class="line">Response::show(200,&quot;随机酒店获取成功&quot;,$res[$random],&quot;json&quot;);</div><div class="line">&#125;else&#123;</div><div class="line">//随机酒店获取失败</div><div class="line">Response::show(201,&quot;随机酒店获取失败&quot;,&quot;json&quot;);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">$hotel = RandomHotel::sharedInstance();</div><div class="line">$hotel-&gt;getHotel();</div><div class="line">?&gt;</div></pre></td></tr></table></figure>
<p>想看完整项目献上传送门：<a href="https://github.com/FantasticLBP/Hotels" target="_blank" rel="external">住哪儿客户端</a>、<a href="https://github.com/FantasticLBP/Hotels_Server" target="_blank" rel="external">住哪儿服务端</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/10/看透构造方法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="杭城小刘">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.JPG">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="杭城小刘">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/10/看透构造方法/" itemprop="url">看透构造方法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-10T14:04:27+08:00">
                2017-10-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="构造方法"><a href="#构造方法" class="headerlink" title="构造方法"></a>构造方法</h1><ul>
<li><p>new方法的内部就是先调用alloc方法，再调用init方法</p>
<ul>
<li><p>alloc方法：那个类接受alloc消息，那么该方法返回该接受类的对象，并把对象返回</p>
</li>
<li><p>init方法：是1个对象方法，作用：初始化对象</p>
</li>
</ul>
</li>
<li><p>创建对象的步骤：先使用alloc创建1个对象，再使用init初始化这个对象，才可以使用这个对象</p>
<ul>
<li>使用1个未被初始化的对象是很危险的</li>
</ul>
</li>
<li><p>init方法：作用：初始化对象，为对象赋初始值，叫做构造方法</p>
</li>
</ul>
<h1 id="重写init构造方法"><a href="#重写init构造方法" class="headerlink" title="重写init构造方法"></a>重写init构造方法</h1><ul>
<li><p>如果想创建出来的对象的属性值不是默认的初始化值，则需要重写init方法</p>
</li>
<li><p>重写init方法的规范：</p>
<ul>
<li><p>必须要先调用父类的init方法（因为当前类初始化就是通过`[父类init]`去初始化），然后将返回值赋值给self</p>
</li>
<li><p>调用init方法有可能会失败，如果失败直接返回nil</p>
</li>
<li><p>判断父类是否初始化成功。如果self != nil，则代表初始化成功</p>
</li>
<li><p>如果初始化成功就去初始化当前对象的属性</p>
</li>
<li><p>最后返回self</p>
</li>
</ul>
</li>
</ul>
<h4 id="解惑："><a href="#解惑：" class="headerlink" title="解惑："></a>解惑：</h4><ol>
<li>为什么要调用父类的init方法？<ol>
<li>当前类有isa指针，当前类的isa指针赋值是通过父类的init方法赋值的。</li>
<li>需要保证当前对象的父类属性同时被初始化</li>
</ol>
</li>
<li>重写init方法的规范：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">-(instancetype)init&#123;</div><div class="line">    if (self = [super init]) &#123;</div><div class="line">        //todo：自定义属性的初始化</div><div class="line">    &#125;</div><div class="line">    return self;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">//Person</div><div class="line"></div><div class="line">#import &lt;Foundation/Foundation.h&gt;</div><div class="line"></div><div class="line">@interface Person : NSObject</div><div class="line">@property NSString* name;</div><div class="line">@property int age;</div><div class="line"></div><div class="line">-(void)sayHi;</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line">#import &quot;Person.h&quot;</div><div class="line">@implementation Person</div><div class="line"></div><div class="line">-(void)sayHi&#123;</div><div class="line">    NSLog(@&quot;Hi&quot;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">-(instancetype)init&#123;</div><div class="line">    self = [super init];</div><div class="line">    if (self) &#123;</div><div class="line">        self.name = @&quot;杭城小刘&quot;;</div><div class="line">        self.age = 22;</div><div class="line">    &#125;</div><div class="line">    return self;</div><div class="line">&#125;</div><div class="line">@end</div><div class="line"></div><div class="line"></div><div class="line">//测试</div><div class="line"></div><div class="line"> Person *p1 = [[Person alloc] init];    //p1.name = &quot;杭城小刘&quot;，p1.age =22;</div><div class="line"> Person *p2 = [Person new];             //p2.name = &quot;杭城小刘&quot;，p2.age =22;</div></pre></td></tr></table></figure>
<p>如果2个类的关系为组合关系，且它的一个属性是另一个类的对象，那么当该类初始化的时候默认它的属性为nil，那么如何初始化？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">-(instancetype)init&#123;</div><div class="line">    self = [super init];</div><div class="line">    if (self) &#123;</div><div class="line">        self.name = @&quot;lbp&quot;;</div><div class="line">        self.age = 22;</div><div class="line">        self.pig = [[Pig alloc] init];</div><div class="line">    &#125;</div><div class="line">    return self;</div><div class="line">&#125;</div><div class="line"></div><div class="line">//测试</div><div class="line">  Person *p1 = [[Person alloc] init];        //p1.dog != nil</div></pre></td></tr></table></figure>
<h1 id="自定义构造方法"><a href="#自定义构造方法" class="headerlink" title="自定义构造方法"></a>自定义构造方法</h1><ul>
<li><p>现状：虽然每次双肩的对象的属性值不是默认的，但是每次初始化的对象的值都是一样的。</p>
</li>
<li><p>需求：每次实例化的对象的属性值由调用者决定</p>
</li>
<li><p>解决办法：自定义构造方法</p>
</li>
<li><p>自定义构造方法规范：</p>
<ul>
<li><p>自定义构造方法的返回值为instancetype</p>
</li>
<li><p>方法的命名必须以initWith开头</p>
</li>
<li><p>方法的实现类似init的实现</p>
</li>
</ul>
</li>
</ul>
<p><strong>注意：此时不能使用new来调用。（因为new的实现是先alloc再init，默认init的实现是给属性赋默认值）</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">-(instancetype)initWithName:(NSString *)name andAge:(int)age&#123;</div><div class="line">    if (self = [super init]) &#123;</div><div class="line">        self.name = name;</div><div class="line">        self.age = age;</div><div class="line">    &#125;</div><div class="line">    return self;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">//Person</div><div class="line">#import &lt;Foundation/Foundation.h&gt;</div><div class="line">@interface Person : NSObject</div><div class="line">@property NSString* name;</div><div class="line">@property int age;</div><div class="line"></div><div class="line">-(instancetype)initWithName:(NSString *)name andAge:(int)age;</div><div class="line">@end</div><div class="line"></div><div class="line">#import &quot;Person.h&quot;</div><div class="line">@implementation Person</div><div class="line"></div><div class="line">-(instancetype)init&#123;</div><div class="line">    self = [super init];</div><div class="line">    if (self) &#123;</div><div class="line">        self.name = @&quot;lbp&quot;;</div><div class="line">        self.age = 22;</div><div class="line">    &#125;</div><div class="line">    return self;</div><div class="line">&#125;</div><div class="line"></div><div class="line">//不能在构造方法之外给self赋值</div><div class="line">//编译器认为只有以initWith开头的方法是构造方法</div><div class="line"></div><div class="line">-(instancetype)initWithName:(NSString *)name andAge:(int)age&#123;</div><div class="line">    if (self = [super init]) &#123;</div><div class="line">        self.name = name;</div><div class="line">        self.age = age;</div><div class="line">    &#125;</div><div class="line">    return self;</div><div class="line">&#125;</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line"></div><div class="line">//测试</div><div class="line"></div><div class="line">Person *p1 = [[Person alloc] init];</div><div class="line">Person *p2 = [Person new];    </div><div class="line">Person *p3 = [[Person alloc] initWithName:@&quot;杭城小刘2号&quot; andAge:23];</div></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/FantasticLBP/iOSKonwledge-Kit/master/assets/屏幕快照%202017-05-23-5-56-53.png" alt="init" title="init"></p>
<p><img src="https://raw.githubusercontent.com/FantasticLBP/iOSKonwledge-Kit/master/assets/屏幕快照%202017-05-23-5-57-08.png" alt="init" title="init"></p>
<p>关于“自定义构造方法必须以initWith开头”做个实验</p>
<p><img src="https://raw.githubusercontent.com/FantasticLBP/iOSKonwledge-Kit/master/assets/屏幕快照%202017-05-23-6-01-29.png" alt="initwith" title="initwith"></p>
<p>报错信息很明显：不能在构造方法之外给self赋值</p>
<p>因为，编译器认为只有以initWith开头的方法是构造方法</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/10/简短代码实现原生定位/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="杭城小刘">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.JPG">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="杭城小刘">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/10/简短代码实现原生定位/" itemprop="url">简短代码实现原生定位</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-10T14:04:27+08:00">
                2017-10-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>1、首先在info.plist文件中加入权限声明。请求用户获取定位能力</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2287777-16e40aa2ce7d0366.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="屏幕快照 2017-04-12 上午8.58.56.png"></p>
<p>2、大体思路。</p>
<p>定位需要用户设备打开定位功能。这个可以根据这句代码判断。[CLLocationManager locationServicesEnables]如果为真则设备开启定位功能，否则没有开启。<br>判断用户是否为该应用设置允许定位可以根据CLLocationManagerDelegate的代理方法判断。具体见下面代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div></pre></td><td class="code"><pre><div class="line">#import &lt;Foundation/Foundation.h&gt;</div><div class="line">@class LocationManager;</div><div class="line">@protocol LocationManagerDelegate &lt;NSObject&gt;</div><div class="line"></div><div class="line">-(void)locationManager:(LocationManager *)locationManager didGotLocation:(NSString *)location;</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line">@interface LocationManager : NSObject</div><div class="line"></div><div class="line">@property (nonatomic, assign) id&lt;LocationManagerDelegate&gt; delegate;</div><div class="line"></div><div class="line">/**</div><div class="line">* 单例模式实例化对象</div><div class="line">*/</div><div class="line">+(LocationManager *)sharedInstance;</div><div class="line">/**</div><div class="line">* 开始定位</div><div class="line">*/</div><div class="line">-(void)autoLocate;</div><div class="line">@end</div><div class="line"></div><div class="line"></div><div class="line">#import &quot;LocationManager.h&quot;</div><div class="line">#import &lt;CoreLocation/CoreLocation.h&gt;</div><div class="line"></div><div class="line">@interface LocationManager()&lt;CLLocationManagerDelegate&gt;</div><div class="line">@property (nonatomic, strong) CLLocationManager *locationManager;</div><div class="line">@end</div><div class="line"></div><div class="line">@implementation LocationManager</div><div class="line"></div><div class="line">+(LocationManager *)sharedInstance&#123;</div><div class="line">static LocationManager *instance = nil;</div><div class="line">static dispatch_once_t predict;</div><div class="line">dispatch_once(&amp;predict, ^&#123;</div><div class="line">instance = [[self alloc] init];</div><div class="line">&#125;);</div><div class="line">return instance;</div><div class="line">&#125;</div><div class="line"></div><div class="line">#pragma mark - private method</div><div class="line">-(void)autoLocate&#123;</div><div class="line">if ([CLLocationManager locationServicesEnabled]) &#123;</div><div class="line">self.locationManager = [[CLLocationManager alloc] init];</div><div class="line">self.locationManager.delegate = self;</div><div class="line">[self.locationManager startUpdatingLocation];</div><div class="line">if ([[[UIDevice currentDevice] systemVersion] floatValue] &gt;= 8.0)&#123;</div><div class="line">[self.locationManager requestWhenInUseAuthorization];</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">#pragma mark - CLLocationManagerDelegate</div><div class="line"></div><div class="line">-(void)locationManager:(CLLocationManager *)manager didFailWithError:(NSError *)error&#123;</div><div class="line">UIAlertController *alertVC = [UIAlertController alertControllerWithTitle:@&quot;打开定位开关&quot; message:@&quot;定位服务未开启，请进入系统【设置】&gt;【隐私】&gt;【定位服务】中打开开关，并允许母子健康手册使用定位服务&quot; preferredStyle:UIAlertControllerStyleAlert];</div><div class="line">UIAlertAction * ok = [UIAlertAction actionWithTitle:@&quot;打开定位&quot; style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) &#123;</div><div class="line">//打开该App的权限设置</div><div class="line">NSURL *settingsURL = [NSURL URLWithString:UIApplicationOpenSettingsURLString];</div><div class="line">[[UIApplication sharedApplication] openURL:settingsURL];</div><div class="line">&#125;];</div><div class="line">UIAlertAction * cancel = [UIAlertAction actionWithTitle:@&quot;取消&quot; style:UIAlertActionStyleCancel handler:^(UIAlertAction * _Nonnull action) &#123;</div><div class="line">&#125;];</div><div class="line">[alertVC addAction:cancel];</div><div class="line">[alertVC addAction:ok];</div><div class="line">[[UIApplication sharedApplication].keyWindow.rootViewController presentViewController:alertVC animated:YES completion:nil];</div><div class="line">&#125;</div><div class="line"></div><div class="line">-(void)locationManager:(CLLocationManager *)manager didUpdateLocations:(NSArray&lt;CLLocation *&gt; *)locations&#123;</div><div class="line">[manager stopUpdatingLocation];</div><div class="line">CLLocation *currentLocation = [locations lastObject];</div><div class="line">CLGeocoder *geocoder = [[CLGeocoder alloc] init];</div><div class="line">[geocoder reverseGeocodeLocation:currentLocation completionHandler:^(NSArray&lt;CLPlacemark *&gt; * _Nullable placemarks, NSError * _Nullable error) &#123;</div><div class="line">CLPlacemark *place = placemarks[0];</div><div class="line">if (self.delegate &amp;&amp; [self.delegate respondsToSelector:@selector(locationManager:didGotLocation:)]) &#123;</div><div class="line">[self.delegate locationManager:self didGotLocation:place.locality];</div><div class="line">&#125;</div><div class="line">&#125;];</div><div class="line">&#125;</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<p>###How to use###</p>
<p>1、在你的文件中导入#import “LocationManager.h”<br>2、遵循LocationManagerDelegate协议<locationmanagerdelegate><br>3、定义属性。@property (nonatomic, strong) LocationManager *locationManager;<br>4、触发定位事件</locationmanagerdelegate></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">//自动定位</div><div class="line">-(void)autoLocate&#123;</div><div class="line">self.locationManager = [LocationManager sharedInstance];</div><div class="line">self.locationManager.delegate = self;</div><div class="line">[self.locationManager autoLocate];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>5、在代理方法中拿到定位城市，更新UI</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">#pragma mark - LocationManagerDelegate</div><div class="line">-(void)locationManager:(LocationManager *)locationManager didGotLocation:(NSString *)location&#123;</div><div class="line">self.conditionView.cityName = location;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>此外，想看完整demo的话，传送门<a href="https://github.com/FantasticLBP/Hotels" target="_blank" rel="external">项目地址</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/10/长按UIWebView上的图片保存到相册/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="杭城小刘">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.JPG">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="杭城小刘">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/10/长按UIWebView上的图片保存到相册/" itemprop="url">模仿微信长按网页图片保存到相册</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-10T14:04:27+08:00">
                2017-10-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="长按UIWebView上的图片保存到相册"><a href="#长按UIWebView上的图片保存到相册" class="headerlink" title="长按UIWebView上的图片保存到相册"></a>长按UIWebView上的图片保存到相册</h1><blockquote>
<p>不知道各位对于这个需求要如何解决？</p>
<p>可能有些人会想到js与原生交互，js监听图片点击事件，然后将图片的url传递给原生App端，然后原生App将图片保存到相册，这样子麻烦吗？超麻烦。（1）、js监听图片长按事件；（2）、js将图片url传递给原生；（3）、原生通过图片的url生成UIImage；（4）、保存UIImage到系统相册，巨麻烦啊，大哥，我很懒的好不好</p>
</blockquote>
<h4 id="那么问题跑出来了，怎么办最简单？"><a href="#那么问题跑出来了，怎么办最简单？" class="headerlink" title="那么问题跑出来了，怎么办最简单？"></a>那么问题跑出来了，怎么办最简单？</h4><ul>
<li><p>鉴于个人道行尚浅，我就将自己的想法说出来</p>
</li>
<li><p>有个js的api：<code>Document.elementFromPoint()</code></p>
</li>
</ul>
<blockquote>
<p>The<code>elementFromPoint()</code>method of the<a href="https://developer.mozilla.org/en-US/docs/Web/API/Document" target="_blank" rel="external"><code>Document</code></a>interface returns the topmost element at the specified coordinates.</p>
</blockquote>
<p>所以根据这个提示，我们完全可以只在App原生端做一些代码开发，实现这个需求</p>
<h4 id="开发步骤"><a href="#开发步骤" class="headerlink" title="开发步骤"></a>开发步骤</h4><p><em>给UIWebView添加长按手势
</em>监听手势动作，拿到坐标点(x,y)<br><em>UIWebView注入js:Document.elementFromPoint(x,y).src拿到img标签的src
</em>判断拿到的src是否有值，有值则代表点击的网页上的img标签，此时弹出对话框，是否保存到相册。如果src为空，则代表点击网页上的非img标签，则不需要弹出对话框。<br>*拿到图片的url，生成UIImage。再将图片保存到相册</p>
<h4 id="有巨坑"><a href="#有巨坑" class="headerlink" title="有巨坑"></a>有巨坑</h4><ul>
<li>长按手势事件不能每次都响应，据我猜测UIWebView本身就有很多事件，所以实现下UIGestureRecognizerDelegate代理方法。长按手势准确率100%</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldRecognizeSimultaneouslyWithGestureRecognizer:(UIGestureRecognizer *)otherGestureRecognizer&#123;</div><div class="line">    return YES;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div></pre></td><td class="code"><pre><div class="line">//</div><div class="line">//  ViewController.m</div><div class="line">//  WebView长按图片保存到相册</div><div class="line">//</div><div class="line">//  Created by 杭城小刘 on 2017/8/2.</div><div class="line">//  Copyright © 2017年 杭城小刘. All rights reserved.</div><div class="line">//</div><div class="line"></div><div class="line">#import &quot;ViewController.h&quot;</div><div class="line"></div><div class="line">@interface ViewController ()&lt;UIGestureRecognizerDelegate,NSURLSessionDelegate&gt;</div><div class="line">@property (weak, nonatomic) IBOutlet UIWebView *webView;</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line">@implementation ViewController</div><div class="line"></div><div class="line">#pragma mark -- life cycle</div><div class="line">- (void)viewDidLoad&#123;</div><div class="line">    [super viewDidLoad];</div><div class="line">    </div><div class="line">    NSString *htmlURL = [[NSBundle mainBundle] pathForResource:@&quot;saveImage&quot; ofType:@&quot;html&quot;];</div><div class="line">    [self.webView loadRequest:[NSURLRequest requestWithURL:[NSURL fileURLWithPath:htmlURL]]];</div><div class="line">    //给UIWebView添加手势</div><div class="line">    UILongPressGestureRecognizer* longPressed = [[UILongPressGestureRecognizer alloc] initWithTarget:self action:@selector(longPressed:)];</div><div class="line">    longPressed.delegate = self;</div><div class="line">    [self.webView addGestureRecognizer:longPressed];</div><div class="line">&#125;</div><div class="line"></div><div class="line">#pragma mark -- UIGestureRecognizerDelegate</div><div class="line">- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldRecognizeSimultaneouslyWithGestureRecognizer:(UIGestureRecognizer *)otherGestureRecognizer&#123;</div><div class="line">    UIActivityTypeAddToReadingList</div><div class="line">    return YES;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)longPressed:(UILongPressGestureRecognizer*)recognizer&#123;</div><div class="line">    if (recognizer.state != UIGestureRecognizerStateBegan) &#123;</div><div class="line">        return;</div><div class="line">    &#125;</div><div class="line">    CGPoint touchPoint = [recognizer locationInView:self.webView];</div><div class="line">    NSString *imgURL = [NSString stringWithFormat:@&quot;document.elementFromPoint(%f, %f).src&quot;, touchPoint.x, touchPoint.y];</div><div class="line">    NSString *urlToSave = [self.webView stringByEvaluatingJavaScriptFromString:imgURL];</div><div class="line">    if (urlToSave.length == 0) &#123;</div><div class="line">        return;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    UIAlertController *alertVC =  [UIAlertController alertControllerWithTitle:@&quot;大宝贝儿&quot; message:@&quot;你真的要保存图片到相册吗？&quot; preferredStyle:UIAlertControllerStyleAlert];</div><div class="line">    UIAlertAction *okAction = [UIAlertAction actionWithTitle:@&quot;真的啊&quot; style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) &#123;</div><div class="line">            [self saveImageToDiskWithUrl:urlToSave];</div><div class="line">    &#125;];</div><div class="line">    UIAlertAction *cancelAction = [UIAlertAction actionWithTitle:@&quot;大哥，我点错了，不好意思&quot; style:UIAlertActionStyleDefault handler:nil];</div><div class="line">    [alertVC addAction:okAction];</div><div class="line">    [alertVC addAction:cancelAction];</div><div class="line">    [self presentViewController:alertVC animated:YES completion:nil];</div><div class="line">&#125;</div><div class="line"></div><div class="line">#pragma mark - private method</div><div class="line">- (void)saveImageToDiskWithUrl:(NSString *)imageUrl&#123;</div><div class="line">    NSURL *url = [NSURL URLWithString:imageUrl];</div><div class="line">    </div><div class="line">    NSURLSessionConfiguration * configuration = [NSURLSessionConfiguration defaultSessionConfiguration];</div><div class="line">    </div><div class="line">    NSURLSession *session = [NSURLSession sessionWithConfiguration:configuration delegate:self delegateQueue:[NSOperationQueue new]];</div><div class="line">    </div><div class="line">    NSURLRequest *imgRequest = [NSURLRequest requestWithURL:url cachePolicy:NSURLRequestReturnCacheDataElseLoad timeoutInterval:30.0];</div><div class="line">    </div><div class="line">    NSURLSessionDownloadTask  *task = [session downloadTaskWithRequest:imgRequest completionHandler:^(NSURL * _Nullable location, NSURLResponse * _Nullable response, NSError * _Nullable error) &#123;</div><div class="line">        if (error) &#123;</div><div class="line">            return ;</div><div class="line">        &#125;</div><div class="line">        NSData * imageData = [NSData dataWithContentsOfURL:location];</div><div class="line">        dispatch_async(dispatch_get_main_queue(), ^&#123;</div><div class="line">            </div><div class="line">            UIImage * image = [UIImage imageWithData:imageData];</div><div class="line">            UIImageWriteToSavedPhotosAlbum(image, self, @selector(imageSavedToPhotosAlbum:didFinishSavingWithError:contextInfo:), NULL);</div><div class="line">        &#125;);</div><div class="line">    &#125;];</div><div class="line">    [task resume];</div><div class="line">&#125;</div><div class="line"></div><div class="line">#pragma mark 保存图片后的回调</div><div class="line">- (void)imageSavedToPhotosAlbum:(UIImage*)image didFinishSavingWithError:  (NSError*)error contextInfo:(id)contextInfo&#123;</div><div class="line">    NSString*message =@&quot;嘿嘿&quot;;</div><div class="line">    if(!error) &#123;</div><div class="line">        UIAlertController *alertControl = [UIAlertController alertControllerWithTitle:@&quot;提示&quot; message:@&quot;成功保存到相册&quot; preferredStyle:UIAlertControllerStyleAlert];</div><div class="line">        </div><div class="line">        UIAlertAction *action = [UIAlertAction actionWithTitle:@&quot;确定&quot; style:UIAlertActionStyleDestructive handler:nil];</div><div class="line">        [alertControl addAction:action];</div><div class="line">        [self presentViewController:alertControl animated:YES completion:nil];</div><div class="line">    &#125;else&#123;</div><div class="line">        message = [error description];</div><div class="line">        UIAlertController *alertControl = [UIAlertController alertControllerWithTitle:@&quot;提示&quot; message:message preferredStyle:UIAlertControllerStyleAlert];</div><div class="line">        UIAlertAction *action = [UIAlertAction actionWithTitle:@&quot;确定&quot; style:UIAlertActionStyleCancel handler:nil];</div><div class="line">        [alertControl addAction:action];</div><div class="line">        [self presentViewController:alertControl animated:YES completion:nil];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<p>附上关键的js官方文档：<a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/elementFromPoint" target="_blank" rel="external">Document.elementFromPoint()</a></p>
<p>附上Demo：<a href="https://github.com/FantasticLBP/BlogDemos" target="_blank" rel="external">Demo</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.JPG"
                alt="杭城小刘" />
            
              <p class="site-author-name" itemprop="name">杭城小刘</p>
              <p class="site-description motion-element" itemprop="description">iOS开发、web开发 | 95后 | 海贼王、龙珠 | 乒乓球 健身 | 杭州</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">18</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/FantasticLBP" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-globe"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="http://weibo.com/3194053975/profile?topnav=1&wvr=6" target="_blank" title="Weibo">
                    
                      <i class="fa fa-fw fa-globe"></i>Weibo</a>
                </span>
              
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">杭城小刘</span>

  
</div>


  <div class="powered-by">powered by 杭城小刘</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  

  

  

</body>
</html>
